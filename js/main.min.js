window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext;window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame;window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame;try{this.audioContext=new AudioContext()}catch(e){this._updateInfo("!Your browser does not support AudioContext",false)}var audioElement=new Audio();var smartSource=function(){if(audioElement.canPlayType("audio/mpeg")){audioElement.setAttribute("src","http://192.30.164.78:8000/rio");$("#mp3").addClass("active")}else{if(audioElement.canPlayType("audio/ogg")){audioElement.setAttribute("src","http://192.30.164.78:8000/airtime");$("#ogg").addClass("active")}}};smartSource();audioElement.controls=false;audioElement.autoplay=false;audioElement.crossOrigin="anonymous";audioElement.id="a";$("#audio-visual")[0].appendChild(audioElement);$("#pause").click(function(){audioElement.pause();$("#pause").addClass("btn-warning");$("#play").removeClass("btn-success");$("#bar").removeClass("active")});$("#reconnect").click(function(){$("#bar").removeClass("active").removeClass("progress-bar-success").addClass("progress-bar-warning");$("#pause").removeClass("btn-warning");smartSource();checkSource();$("#play").removeClass("btn-success");play()});var play=function(){audioElement.play();$("#pause").removeClass("btn-warning");$("#bar").addClass("active");$("#play").addClass("btn-success")};$("#play").click(function(){play()});play();audioElement.addEventListener("stalled",function(){redZone()});audioElement.addEventListener("loadstart",function(){$("#bar").addClass("progress-bar-info").removeClass("progress-bar-danger").removeClass("progress-bar-warning").addClass("active");$("#play").removeClass("btn-danger").removeClass("btn-success");$("#pause").removeClass("btn-danger")});audioElement.addEventListener("canplay",function(){$("#bar").addClass("progress-bar-success").removeClass("progress-bar-info").removeClass("progress-bar-danger").removeClass("progress-bar-warning");$("#play").removeClass("btn-danger").removeClass("btn-success");$("#pause").removeClass("btn-danger");if(audioElement.paused){}else{$("#play").addClass("btn-success");$("#pause").removeClass("btn-warning")}});audioElement.addEventListener("abort",function(){redZone()});var redZone=function(){};var canvas=$("#c")[0];var canvasCtx=canvas.getContext("2d");var context=new (window.AudioContext||window.webkitAudioContext)();var analyser=context.createAnalyser();analyser.fftSize=256;analyser.smoothingTimeConstant=0.5;function freqAnalyser(){window.requestAnimationFrame(freqAnalyser);var h;var b;var a;var c;var l=24;var g=new Uint8Array(128);analyser.getByteFrequencyData(g);if(!analyser){$("#vis").html(g[0])}canvasCtx.clearRect(0,0,canvas.width,canvas.height);var k=canvasCtx.createLinearGradient(0,canvas.height,0,0);k.addColorStop(0,"#28B62C");k.addColorStop(0.8,"#F5D802");k.addColorStop(1,"red");canvasCtx.fillStyle=k;var m=Math.floor((g.length-40)/l);for(var f=0;f<l;f++){h=0;for(var d=0;d<m;d++){h+=g[(f*m)+d]}b=h/m;a=canvas.width/l;c=(b/256)*canvas.height;canvasCtx.fillRect(f*a,canvas.height,a/1.1,-c)}}var checkSource=function(){if($("#a")[0].src==="http://192.30.164.78:8000/rio"){$("#mp3").addClass("active");$("#ogg").removeClass("active")}else{if($("#a")[0].src==="http://192.30.164.78:8000/airtime"){$("#mp3").removeClass("active");$("#ogg").addClass("active")}}};function respondCanvas(){canvas.width=$("#bottom").width();canvas.height=$("#controlAudio").height()-72}$("document").ready(function(){var a=context.createMediaElementSource(audioElement);a.connect(analyser);analyser.connect(context.destination);freqAnalyser();respondCanvas();$(window).resize(respondCanvas);$("#headerLiveTrackHolder").airtimeLiveTrackInfo({sourceDomain:"http://radio.riocast.net",text:{onAirNow:"AL AIRE",offline:"Offline",current:"Reproduciéndo ahora",next:"Próximamente"},updatePeriod:20});$("#onAirToday").airtimeShowSchedule({sourceDomain:"http://radio.riocast.net",updatePeriod:20,showLimit:20});if(window.audioContext||window.webkitAudioContext){}else{$("#vis").hide()}});