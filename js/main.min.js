function freqAnalyser(){window.requestAnimationFrame(freqAnalyser);var e,a,n,t,o=16,s=new Uint8Array(128);analyser.getByteFrequencyData(s),analyser||$("#vis").html(s[0]),canvasCtx.clearRect(0,0,canvas.width,canvas.height);var i=canvasCtx.createLinearGradient(0,canvas.height,0,0);i.addColorStop(0,"#4caf50"),i.addColorStop(.5,"#cddc39"),i.addColorStop(.98,"#f44336"),canvasCtx.fillStyle=i;for(var r=Math.floor((s.length-40)/o),d=0;d<o;d++){e=0;for(var c=0;c<r;c++)e+=s[d*r+c];a=e/r,n=canvas.width/o,t=a/256*canvas.height,canvasCtx.fillRect(d*n,canvas.height,n/1.1,-t)}}function respondCanvas(){canvas.width=$("#bottom").width(),canvas.height=$("#controlAudio").height()-72}window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame;try{this.audioContext=new AudioContext}catch(e){this._updateInfo("!Your browser does not support AudioContext",!1)}var audioElement=new Audio,smartSource=function(){audioElement.canPlayType("audio/mpeg")?(audioElement.setAttribute("src","http://192.30.164.78:8000/bahia"),$("#mp3").addClass("active")):audioElement.canPlayType("audio/ogg")&&(audioElement.setAttribute("src","http://192.30.164.78:8000/airtime"),$("#ogg").addClass("active"))};smartSource(),audioElement.controls=!1,audioElement.autoplay=!1,audioElement.crossOrigin="anonymous",audioElement.id="a",$("#audio-visual")[0].appendChild(audioElement),$("#pause").click(function(){audioElement.pause(),$("#pause").addClass("btn-warning"),$("#play").removeClass("btn-success"),$("#bar").removeClass("active")}),$("#reconnect").click(function(){$("#bar").removeClass("active").removeClass("progress-bar-success").addClass("progress-bar-warning"),$("#pause").removeClass("btn-warning"),smartSource(),checkSource(),$("#play").removeClass("btn-success"),play()});var play=function(){audioElement.play(),$("#pause").removeClass("btn-warning"),$("#bar").addClass("active"),$("#play").addClass("btn-success")};$("#play").click(function(){play()}),play(),audioElement.addEventListener("loadstart",function(){$("#bar").addClass("progress-bar-info").removeClass("progress-bar-danger").removeClass("progress-bar-warning").addClass("active"),$("#play").removeClass("btn-danger").removeClass("btn-success"),$("#pause").removeClass("btn-danger")}),audioElement.addEventListener("canplay",function(){$("#bar").addClass("progress-bar-success").removeClass("progress-bar-info").removeClass("progress-bar-danger").removeClass("progress-bar-warning"),$("#play").removeClass("btn-danger").removeClass("btn-success"),$("#pause").removeClass("btn-danger"),audioElement.paused||($("#play").addClass("btn-success"),$("#pause").removeClass("btn-warning"))});var canvas=$("#c")[0],canvasCtx=canvas.getContext("2d"),context=new(window.AudioContext||window.webkitAudioContext),analyser=context.createAnalyser();analyser.fftSize=256,analyser.smoothingTimeConstant=.2,analyser.minDecibels=-98,analyser.maxDecibels=-32;var checkSource=function(){"http://192.30.164.78:8000/rio"===$("#a")[0].src?($("#mp3").addClass("active"),$("#ogg").removeClass("active")):"http://192.30.164.78:8000/airtime"===$("#a")[0].src&&($("#mp3").removeClass("active"),$("#ogg").addClass("active"))};$("document").ready(function(){var e=context.createMediaElementSource(audioElement);e.connect(analyser),analyser.connect(context.destination),freqAnalyser(),respondCanvas(),$(window).resize(respondCanvas),$("#headerLiveTrackHolder").airtimeLiveTrackInfo({sourceDomain:"http://radio.riocast.net",text:{onAirNow:"AL AIRE",offline:"Offline",current:"Reproduciéndo ahora",next:"Próximamente"},updatePeriod:20}),$("#onAirToday").airtimeShowSchedule({sourceDomain:"http://radio.riocast.net",updatePeriod:20,showLimit:20}),window.audioContext||window.webkitAudioContext||$("#vis").hide()});